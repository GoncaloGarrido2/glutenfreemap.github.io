---
layout: base
---
{% assign language = site.languages | where: "id", page.lang | first %}
<header>
    <nav
        class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3">
        <div class="container">
            {% include brand.html %}
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav flex-grow-1">
                    <li class="nav-item">
                        <a class="nav-link text-dark" href=".">{{ language.links.map }}</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-dark" href="about.html">{{ language.links.about }}</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            {{ language.name }}
                        </a>
                        <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                            {% for language in site.languages %}
                                <li><a class="dropdown-item" href="{{ page.url | replace_first: page.lang, language.id }}">{{ language.name }}</a></li>
                            {% endfor %}
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
</header>

{{ content }}

<div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
    <div id="installPrompt" class="toast hide" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <i class="gg-export"></i>
            &nbsp;<strong class="me-auto">{{ language.install.title }}</strong>
        </div>
        <div class="toast-body">
            {{ language.install.description }}
            <div class="mt-2 pt-2 border-top">
                <button id="installButton" type="button" class="btn btn-primary btn-sm">{{ language.install.accept }}</button>
                <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="toast">{{ language.install.cancel }}</button>
            </div>
        </div>
    </div>
</div>

<script>
    window.localStorage.setItem("preferences.language", "{{ language.id }}");

    if ("serviceWorker" in navigator) {
        navigator.serviceWorker
            .register("/sw.js")
            .then(() => console.log("service worker registered"));
    }

    window.addEventListener("beforeinstallprompt", e => {
        // Prevent Chrome 67 and earlier from automatically showing the prompt
        e.preventDefault();
        // Stash the event so it can be triggered later.
        const deferredPrompt = e;

        const installPrompt = new bootstrap.Toast(document.getElementById("installPrompt"), {
            autohide: false
        });
        installPrompt.show();

        document.getElementById("installButton").addEventListener("click", e => {
            // hide our user interface that shows our A2HS button
            installPrompt.hide();

            // Show the prompt
            deferredPrompt.prompt();
            // Wait for the user to respond to the prompt
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === "accepted") {
                    console.log("User accepted the A2HS prompt");
                } else {
                    console.log("User dismissed the A2HS prompt");
                }
                deferredPrompt = null;
            });
        });
    });
</script>
